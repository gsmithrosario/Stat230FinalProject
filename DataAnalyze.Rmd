---
title: "DataAnalyze"
author: "Gabi Smith-Rosario and Andrea Boskovic"
date: "4/15/2018"
output: html_document
---

```{r, include=FALSE}
require(mosaic);require(leaps); require(car); require(MASS); require(ggplot2)
```

```{r}
summary(RodentsP)
```

```{r}
#CHECK for multicollinearity
#throw in the kitchen sink

fullmodel<-lm(MaxLongevitym ~ AdultBodyMassg + GestationLend + HabitatBreadth + LitterSize + LittersPerYear + PopulationDensitynkm + SexualMaturityAged + WeaningAged + HuPopDenMeannkm + HuPopDenpnkm + HuPopDenChange + TempMeandegC, data=RodentsP)
summary(fullmodel)
vif(fullmodel)

collist <- c("MaxLongevitym", "AdultBodyMassg", "GestationLend", "HabitatBreadth", "LitterSize", "LittersPerYear", "PopulationDensitynkm", "SexualMaturityAged", "WeaningAged", "HuPopDenMeannkm", "HuPopDenpnkm", "HuPopDenChange", "TempMeandegC")

RodentsSelect <- RodentsP[complete.cases(RodentsP[collist]), collist]

fit <- lm(MaxLongevitym ~ AdultBodyMassg + GestationLend + HabitatBreadth + LitterSize + LittersPerYear + PopulationDensitynkm + SexualMaturityAged + WeaningAged + HuPopDenMeannkm + HuPopDenpnkm + HuPopDenChange + TempMeandegC, data=RodentsSelect)
stepAIC(fit, direction="backward",trace=FALSE)$anova
```


```{r}
mod1 <- lm(MaxLongevitym ~ AdultBodyMassg + LitterSize + WeaningAged + HuPopDenChange, data = RodentsP)
plot(mod1,which=1)
plot(mod1,which=2)
summary(mod1)
anova(mod1)
vif(mod1) 
```
no multicollinearity

```{r}
xyplot(MaxLongevitym ~ AdultBodyMassg, type=c("p","r"),data=RodentsP)
```

```{r}
xyplot(MaxLongevitym ~ LitterSize, type=c("p","r"), data=RodentsP)
```

```{r}
xyplot(MaxLongevitym ~ WeaningAged, type=c("p","r"), data=RodentsP)
```

```{r}
xyplot(MaxLongevitym ~ HuPopDenChange, type=c("p","r"), data=RodentsP)
```

```{r}
#Do we need HuPopDenChange?
fm1 <- lm(MaxLongevitym~HuPopDenChange, data = RodentsP)
fm2 <- lm(HuPopDenChange ~ AdultBodyMassg + LitterSize + WeaningAged, data=RodentsP)
plotPoints(fm1$residuals ~ fm2$residuals, type=c("p", "r"), pch=19, alpha=0.3, cex=2, main="Added Variable Plot for HuPopDenChange")
```

```{r bootstrap}
#Check if we really need HuPopDenChange in the model
bootstrap <- do(1000) * lm(MaxLongevitym~AdultBodyMassg + LitterSize + WeaningAged + HuPopDenChange, data=RodentsP[resample(1:nrow(RodentsP)),])$coefficients
densityplot(~HuPopDenChange, data=bootstrap)

ladd(panel.abline(v=mod1$coefficients["HuPopDenChange"], col="red", lwd=3))

c(mod1$coefficients["HuPopDenChange"] - 1.96 * sd(bootstrap$HuPopDenChange), mod1$coefficients["HuPopDenChange"] + 1.96 * sd(bootstrap$HuPopDenChange))
```
probably take out HupopDenchange

```{r}
mod2<-lm(MaxLongevitym~AdultBodyMassg + LitterSize + WeaningAged, data = RodentsP)
summary(mod2)
anova(mod2)
vif(mod2)
confint(mod2)
```
good!!

general conditions:
```{r}
plot(mod2, which=1)
plot(mod2, which=2)
```

identifying unusual/influential pts
```{r}
plot(mod2,which=3)
plot(mod2,which=4)
plot(mod2,which=5)
plot(mod2,which=6)
```
problematic pt in model seem to be 237

```{r}
mplot(RodentsP)
```
ggplot( data = RodentsP, aes(x = HuPopDenChange)) + geom_histogram(binwidth = 0.04) + aes(colour = ActivityCycle) + labs(title = "")

